VV=require("./core");var cryptoLib=require("crypto"),vaultUtilBase64Helper=function(){function n(n){this._vaultUtil=n}return n.prototype.encode=function(n){return new Buffer(n).toString("base64",null,null)},n.prototype.decode=function(n){return new Buffer(n,"base64").toString(null,null,null)},n}(),vaultUtilBufferHelper=function(){function n(n){this._vaultUtil=n}return n.prototype.concat=function(n){for(var r=0,u=0,i=null,t=0;t<n.length;t++)r+=n[t].length;for(i=new Buffer(r),t=0;t<n.length;t++)n[t].copy(i,u),u+=n[t].length;return i},n}(),vaultUtilStringHelper=function(){function n(n){this._vaultUtil=n}return n.prototype.byteLength=function(n){if(n===null||n===undefined)return 0;if(typeof n=="string"&&(n=new Buffer(n)),n.length!==undefined)return n.length;if(typeof n.path=="string")return require("fs").lstatSync(n.path).size;throw this._vaultUtil.error(new Error,{message:"Cannot determine length of "+n,object:n});},n}(),vaultUtilCryptoHelper=function(){function n(n){this.crc32Table=[0,1996959894,3993919788,2567524794,124634137,1886057615,3915621685,2657392035,249268274,2044508324,3772115230,2547177864,162941995,2125561021,3887607047,2428444049,498536548,1789927666,4089016648,2227061214,450548861,1843258603,4107580753,2211677639,325883990,1684777152,4251122042,2321926636,335633487,1661365465,4195302755,2366115317,997073096,1281953886,3579855332,2724688242,1006888145,1258607687,3524101629,2768942443,901097722,1119000684,3686517206,2898065728,853044451,1172266101,3705015759,2882616665,651767980,1373503546,3369554304,3218104598,565507253,1454621731,3485111705,3099436303,671266974,1594198024,3322730930,2970347812,795835527,1483230225,3244367275,3060149565,1994146192,31158534,2563907772,4023717930,1907459465,112637215,2680153253,3904427059,2013776290,251722036,2517215374,3775830040,2137656763,141376813,2439277719,3865271297,1802195444,476864866,2238001368,4066508878,1812370925,453092731,2181625025,4111451223,1706088902,314042704,2344532202,4240017532,1658658271,366619977,2362670323,4224994405,1303535960,984961486,2747007092,3569037538,1256170817,1037604311,2765210733,3554079995,1131014506,879679996,2909243462,3663771856,1141124467,855842277,2852801631,3708648649,1342533948,654459306,3188396048,3373015174,1466479909,544179635,3110523913,3462522015,1591671054,702138776,2966460450,3352799412,1504918807,783551873,3082640443,3233442989,3988292384,2596254646,62317068,1957810842,3939845945,2647816111,81470997,1943803523,3814918930,2489596804,225274430,2053790376,3826175755,2466906013,167816743,2097651377,4027552580,2265490386,503444072,1762050814,4150417245,2154129355,426522225,1852507879,4275313526,2312317920,282753626,1742555852,4189708143,2394877945,397917763,1622183637,3604390888,2714866558,953729732,1340076626,3518719985,2797360999,1068828381,1219638859,3624741850,2936675148,906185462,1090812512,3747672003,2825379669,829329135,1181335161,3412177804,3160834842,628085408,1382605366,3423369109,3138078467,570562233,1426400815,3317316542,2998733608,733239954,1555261956,3268935591,3050360625,752459403,1541320221,2607071920,3965973030,1969922972,40735498,2617837225,3943577151,1913087877,83908371,2512341634,3803740692,2075208622,213261112,2463272603,3855990285,2094854071,198958881,2262029012,4057260610,1759359992,534414190,2176718541,4139329115,1873836001,414664567,2282248934,4279200368,1711684554,285281116,2405801727,4167216745,1634467795,376229701,2685067896,3608007406,1308918612,956543938,2808555105,3495958263,1231636301,1047427035,2932959818,3654703836,1088359270,936918e3,2847714899,3736837829,1202900863,817233897,3183342108,3401237130,1404277552,615818150,3134207493,3453421203,1423857449,601450431,3009837614,3294710456,1567103746,711928724,3020668471,3272380065,1510334235,755167117],this._vaultUtil=n}return n.prototype.crc32=function(n){var r=this.crc32Table,t=-1,i;for(typeof n=="string"&&(n=new Buffer(n)),i=0;i<n.length;i++)t=t>>>8^r[(t^n[i])&255];return(t^-1)>>>0},n.prototype.hmac=function(n,t,i,r){return i||(i="binary"),r||(r="sha256"),cryptoLib.createHmac(r,n).update(t).digest(i)},n.prototype.md5=function(n,t){return t||(t="binary"),typeof n=="string"&&(n=new Buffer(n)),this.createHash("md5").update(n).digest(t)},n.prototype.sha256=function(n,t){return t||(t="binary"),typeof n=="string"&&(n=new Buffer(n)),this.createHash("sha256").update(n).digest(t)},n.prototype.toHex=function(n){for(var i=[],t=0;t<n.length;t++)i.push(("0"+n.charCodeAt(t).toString(16)).substr(-2,2));return i.join("")},n.prototype.createHash=function(n){return cryptoLib.createHash(n)},n}(),vaultUtilDateHelper=function(){function n(n){this._vaultUtil=n}return n.prototype.getDate=function(){return new Date},n.prototype.iso8601=function(n){return n===undefined&&(n=this.getDate()),n.toISOString()},n.prototype.rfc822=function(n){return n===undefined&&(n=this.getDate()),n.toUTCString()},n.prototype.unixTimestamp=function(n){return n===undefined&&(n=this.getDate()),n.getTime()/1e3},n.prototype.from=function(n){return typeof n=="number"?new Date(n*1e3):new Date(n)},n.prototype.format=function(n,t){return t||(t="iso8601"),this[t](this.from(n))},n}(),VaultUtility=function(){function n(){this.abort={},this.base64=new vaultUtilBase64Helper(this),this.buffer=new vaultUtilBufferHelper(this),this.string=new vaultUtilStringHelper(this),this.date=new vaultUtilDateHelper(this),this.crypto=new vaultUtilCryptoHelper(this)}return n.prototype.engine=function(){return process.platform+"/"+process.version},n.prototype.userAgent=function(){return"vvclient-nodejs/"+VV.VERSION+" "+this.engine()},n.prototype.uriEscape=function(n){var t=encodeURIComponent(n);return t=t.replace(/[^A-Za-z0-9_.~\-%]+/g,escape),t.replace(/[*]/g,function(n){return"%"+n.charCodeAt(0).toString(16).toUpperCase()})},n.prototype.uriEscapePath=function(n){var t=[];return this.arrayEach(n.split("/"),function(n){t.push(this.uriEscape(n))}),t.join("/")},n.prototype.urlParse=function(n){return require("url").parse(n)},n.prototype.queryParamsToString=function(n){var i=[],t=VV.util.uriEscape,r=Object.keys(n).sort();return VV.util.arrayEach(r,function(r){var u=n[r],f=t(r),e=f,o;Array.isArray(u)?(o=[],VV.util.arrayEach(u,function(n){o.push(t(n))}),e=f+"="+o.sort().join("&"+f+"=")):u!==undefined&&u!==null&&(e=f+"="+t(u)),i.push(e)}),i.join("&")},n.prototype.readFileSync=function(n){return require("fs").readFileSync(n,"utf-8")},n.prototype.each=function(n,t){var i,r;for(i in n)if(n.hasOwnProperty(i)&&(r=t.call(this,i,n[i]),r===VV.util.abort))break},n.prototype.arrayEach=function(n,t){var i,r;for(i in n)if(n.hasOwnProperty(i)&&(r=t.call(this,n[i],parseInt(i,10)),r===VV.util.abort))break},n.prototype.update=function(n,t){return VV.util.each(t,function(t,i){n[t]=i}),n},n.prototype.merge=function(n,t){return this.update(this.copy(n),t)},n.prototype.copy=function(n){var t,i;if(n===null||n===undefined)return n;t={};for(i in n)t[i]=n[i];return t},n.prototype.isEmpty=function(n){for(var t in n)if(n.hasOwnProperty(t))return!1;return!0},n.prototype.isType=function(n,t){return typeof t=="function"&&(t=t.name),Object.prototype.toString.call(n)==="[object "+t+"]"},n.prototype.error=function(n,t){return n.message=n.message||null,typeof t=="string"?n.message=t:this.update(n,t),n.name=n.code||"Error",n},n.prototype.inherit=function(n,t){var i=null,r;return t===undefined?(t=n,n=Object,i={}):(r=function(){},r.prototype=n.prototype,i=new r),t.constructor===Object&&(t.constructor=function(){if(n!==Object)return n.apply(this,arguments)}),t.constructor.prototype=i,VV.util.update(t.constructor.prototype,t),t.constructor.__super__=n,t.constructor},n.prototype.mixin=function(){for(var i=arguments[0],t,r,n=1;n<arguments.length;n++)for(t in arguments[n].prototype)r=arguments[n].prototype[t],t!="constructor"&&(i.prototype[t]=r);return i},n}();VV.util=new VaultUtility,module.exports=VV.util